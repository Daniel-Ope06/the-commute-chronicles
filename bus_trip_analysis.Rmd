---
title: "The Commute Chronicles"
subtitle: "An Analysis of Travel Efficiency, Weather Impacts, and Crowding"
author: "Opeoluwa Daniel Oyedeji"
date: "December 5, 2025"
output:
  bookdown::pdf_document2:
    toc: true
    toc_depth: 3
    number_sections: true
    highlight: tango
    df_print: kable
    extra_dependencies: ["float"]
fontsize: 11pt
geometry: margin=1in
urlcolor: blue
header-includes:
  - \usepackage[font=small,labelfont=bf]{caption}
  - \usepackage[default]{lato}
  - \usepackage[scale=0.9]{sourcecodepro}
  - \usepackage[T1]{fontenc}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.pos="H", fig.showtext = TRUE, out.extra="", dev="cairo_pdf")
```

# Introduction

# Methods and Results

## Exploratory Data Analysis

### Dataset Overview

```{r loadData}
df <- read.csv("bus_trip_data.csv")
df$date <- as.Date(df$date) # Convert date column to R Date type
```

The data has `r ncol(df)` columns and `r nrow(df)` rows. To ensure the table fits within the document margins, the data set is displayed below in two parts: the "To Campus" details and the "To Home" details.

```{r display-table-1, echo=FALSE}
df_display_1 <- df[ , 1:5]
head(df_display_1, 1)
```

```{r display-table-2, echo=FALSE}
df_display_2 <- df[ , 6:10]
head(df_display_2, 1)
```


```{r delete-display-variables, include=FALSE}
# Remove them to keep the environment clean
rm(df_display_1, df_display_2)
```

### Visual Inspection of Trends

Before running any complex statistical tests, we visualize the raw data to understand its shape. We are looking for two things: the **distribution** of the data (e.g. is it bell-shaped?) and any **trends** over time (e.g. is traffic getting worse?).

```{r histogram-side, echo=FALSE, fig.show="hold", out.width="50%", fig.cap="Histograms displaying the distribution of travel times for trips to campus (left) and trips to home (right) with 10-minute bin intervals."}
par(mar = c(4, 4, 1, .1))

hist(df$dur_to_campus, 
     main = "Distribution of Commute Duration to Campus",
     xlab = "Duration (Minutes)", 
     col = "lightblue", 
     border = "white",
     breaks = 10)

hist(df$dur_to_home,
     main = "Distribution of Commute Duration to Home",
     xlab = "Duration (Minutes)", 
     col = "salmon", 
     border = "white",
     breaks = 10)
```

An examination of the distributional shape (Figure \@ref(fig:histogram-side)) highlights the following patterns:

- Both histograms exhibit a *positive skew* and a detached bar at the far right, indicating a *potential outlier* that may need to be addressed in our statistical tests.

- Both histograms are *unimodal* with the mode being around the *120-130 minute interval*.


```{r scatter-plot-side, echo=FALSE, fig.show="hold", out.width="50%", fig.cap="Scatter plots tracking daily commute durations for trips to campus (left) and return trips to home (right) over the observed period."}
par(mar = c(4, 4, 1, .1))

plot(df$date, df$dur_to_campus,
     main = "Commute Duration Over Time To Campus",
     xlab = "Date",
     ylab = "Duration (Minutes)",
     pch = 19,
     col = "lightblue",
     frame.plot = FALSE)

plot(df$date, df$dur_to_home,
     main = "Commute Duration Over Time To Home",
     xlab = "Date",
     ylab = "Duration (Minutes)",
     pch = 19,
     col = "salmon",
     frame.plot = FALSE)
```

Plotting the commute durations over time (Figure \@ref(fig:scatter-plot-side)) highlights a stark contrast in stability between the two journeys:

- Trips to campus appear stable over time, showing only random noise without a noticeable increase or decrease in duration.

- Trips to home exhibit high variance, with widely dispersed data points, suggesting unpredictable delays that warrant further statistical testing.

```{r stacked-bar-side, echo=FALSE, fig.cap="Stacked bar chart showing the proportion of crowded UniLink buses to home during clear weather versus rain.", out.width="70%", fig.align="center"}
# 'Rain' on the X-axis and 'Crowded' stacked as the bars
counts <- table(df$crowded_unilink_to_home, df$rain_to_home)

# Rename the rows & cols for a cleaner plot text
colnames(counts) <- c("No Rain", "Rain")
rownames(counts) <- c("Not Crowded", "Crowded")

barplot(counts,
        main = "Bus Crowding vs. Weather Conditions",
        xlab = "Weather Condition",
        ylab = "Number of Trips",
        col = c("lightblue", "salmon"),
        legend = rownames(counts),
        args.legend = list(x = "topleft", bty = "n"))

rm(counts)
```

An analysis of the interaction between weather and bus capacity (Figure \@ref(fig:stacked-bar-side)) suggests a strong correlation:

- **On clear days**, the distribution is balanced, with the bus being crowded roughly half the time.

- **On rainy days**, the vast majority of trips experience overcrowding, likely due to an increase in students choosing public transport over walking or cycling.

## Statistical Analysis Plan

While the exploratory analysis highlighted potential trends, such as the volatility of the evening commute and the correlation between rain and crowding, visual inspection alone is insufficient to draw firm conclusions. In this section, we define the specific hypotheses derived from our observations and outline the statistical methods selected to test them.

### Comparing Commute Directions (Paired t-test)

The scatter plot (Figure \@ref(fig:scatter-plot-side)) suggested that the journey home is not only more volatile but potentially longer on average than the morning commute. To confirm this, we analyse the difference in means between the two trips.

#### Method Justification:{.unnumbered}

Since each day (or record) consists of a trip to campus and a trip to home, a paired student t-test is the appropriate method to control for day-specific variance (e.g., a generally traffic-heavy day affecting both trips).

- $H_0$ (Null): There is no significant difference in mean duration between the trip to campus and the trip home ($\mu_{campus} = \mu_{home}$).

- $H_a$ (Alternative): The trip home takes significantly longer than the trip to campus ($\mu_{home} > \mu_{campus}$).

### Predictability of Arrival Times (Linear Regression)

We aim to understand the relationship between departure time and arrival time. Specifically, we want to assess if a linear model can accurately predict arrival times, or if traffic delays introduce non-linear variance.

#### Method Justification:{.unnumbered}

We use *Simple Linear Regression* to quantify the relationship between the independent variable (Departure) and the dependent variable (Arrival). Rather than a hypothesis test, the goal here is to assess the goodness of fit ($R^2$) to see how much of the variance in arrival time can be explained purely by the time of departure.

### The "Rain Effect" on Crowding (Fisher's Exact Test)

The bar chart (Figure \@ref(fig:stacked-bar-side)) indicated a strong dependency between rainy weather and bus overcrowding. We aim to calculate the statistical significance of this association.

#### Method Justification:{.unnumbered}

We are analyzing two categorical, binary variables (`rain_to_home` vs. `crowded_unilink_to_home`). This structure results in a $2 \times 2$ contingency table which Fisher’s Exact Test is well suited for.

- $H_0$ (Null): Weather conditions and bus crowding are independent.

- $H_a$ (Alternative): Rainy weather significantly increases the likelihood of the bus being crowded.

### Weekday Crowding Variance (Pearson's Chi-Square)

We investigate the specific phenomenon of the *"Thursday Rush."* Personal experience suggests that Thursdays are disproportionately crowded compared to other weekdays. This is probably because on Thursdays, I depart campus around 18:00 (6 PM), coinciding with the general close of business for local offices, while on other days I leave earlier.

#### Method Justification:{.unnumbered}

We examine the frequency of crowded buses across the distinct days of the week. Pearson’s Chi-square Test is chosen to determine if the distribution of crowded trips differs significantly from what we would expect by chance. Unlike Fisher's Exact Test (which we used for a $2 \times 2$ comparison), Chi-square is ideal for this $2 \times 4$ matrix (Crowded/Not Crowded vs. Mon/Wed/Thu/Fri).

### Conditional Probability of Events: Rain vs. Crowding (Bayes's Theorem)

While the previous tests determine if a relationship exists, we use Bayes's Theorem to quantify the dependency between the event **"It is Raining"** and the event **"The Bus is Crowded."** Specifically, we aim to measure how the presence of rain updates the probability of the bus being full.

#### Method Justification:{.unnumbered}

This is not a hypothesis test for statistical significance, but a Probability Update. We will calculate the **Prior Probability** ($P(Crowded)$), the baseline chance of a crowded bus on any random day, and compare it to the **Posterior Probability** ($P(Crowded | Rain)$).

- If $P(Crowded|Rain) = P(Crowded)$, the events are **Independent** (Rain has no effect).

- If $P(Crowded|Rain) > P(Crowded)$, the events are **Dependent**, and rain acts as a positive risk factor.

## Results and Interpretation

### Difference in Commute Durations

To determine if the journey home is statistically longer than the journey to campus, we performed a **paired t-test**. This controls for day-specific traffic conditions by comparing the two specific trips made on each date.

$$
\begin{aligned}
H_0 &: \mu_{home} = \mu_{campus} \\
H_a &: \mu_{home} > \mu_{campus}
\end{aligned}
$$

```{r paired-t-test, collapse = TRUE, comment = "#>"}
t_result <- t.test(df$dur_to_home, df$dur_to_campus,
                   paired = TRUE, alternative = "greater")
t_result
```

The test yields a **p-value of `r signif(t_result$p.value, 4)`**.

- **Decision:** Since the p-value is **greater** than the significant level ($\alpha = 0.05$), we **fail to reject** the null hypothesis.

- **Interpretation:** There is **insufficient** evidence to conclude that the trip back home takes significantly longer than the trip to campus.
